!function(i,s,d){"use strict";var c={};(i.ARIAmodal=c).NS="ARIAmodal",c.AUTHOR="Scott O'Hara",c.VERSION="3.4.1",c.LICENSE="https://github.com/scottaohara/accessible_modal_window/blob/master/LICENSE";var l,n,r="modal-open",u=s.body,h=s.getElementsByTagName("main")[0]||u,b=s.querySelectorAll("[data-modal]"),m=s.querySelectorAll("body > *:not([data-modal])"),g=!1,A=!1,f="js-first-focus",p="js-last-focus";c.organizeDOM=function(){var t,e=u.firstElementChild||null;for(t=0;t<b.length;t++)u.insertBefore(b[t],e)},c.setupTrigger=function(){var t,e,a=s.querySelectorAll("[data-modal-open]");for(e=0;e<a.length;e++){var o=(t=a[e]).getAttribute("data-modal-open"),d=t.getAttribute("href");"BUTTON"!==t.nodeName&&(t.setAttribute("role","button"),t.tabIndex=0),""===o&&d&&(t.setAttribute("data-modal-open",d.split("#")[1]),o=d.split("#")[1]),t.removeAttribute("href"),o?(t.hasAttribute("disabled")&&!t.hasAttribute("data-modal-disabled")&&t.removeAttribute("disabled"),t.removeAttribute("hidden"),t.id=o+"__trigger-"+t.nodeName+"-"+e,t.addEventListener("click",c.openModal),t.addEventListener("keydown",c.keyEvents,!1)):console.warn('Missing target modal dialog - [data-modal-open="IDREF"]')}},c.setupModal=function(){var t;for(t=0;t<b.length;t++){var e,a=(e=b[t]).getAttribute("data-modal"),o=e.getAttribute("data-modal-class")||"a11y-modal",d=e.querySelector("h1, h2, h3, h4, h5, h6"),i=e.getAttribute("data-modal-label"),l=e.hasAttribute("data-modal-hide-heading"),n=e.querySelector("[data-modal-description]"),r=e.querySelector("[data-modal-document]");if("alert"===a?e.setAttribute("role","alertdialog"):e.setAttribute("role","dialog"),e.classList.add(o),e.hidden=!0,e.tabIndex="-1",r&&r.setAttribute("role","document"),c.setupModalCloseBtn(e,o,a),e.hasAttribute("data-aria-modal")&&e.setAttribute("aria-modal","true"),n&&(n.id=n.id||"md_desc_"+Math.floor(999*Math.random())+1,e.setAttribute("aria-describedby",n.id)),i)e.setAttribute("aria-label",i);else if(d){var s=e.id+"_heading";d.classList.add(o+"__heading"),d.id=s,e.setAttribute("aria-labelledby",s),d.hasAttribute("data-autofocus")&&(d.tabIndex="-1")}else console.warn("Dialogs should have their purpose conveyed by a heading element (h1).");l&&e.querySelector("#"+d.id).classList.add("at-only");var u=e.querySelectorAll('button:not([hidden]):not([disabled]), [href]:not([hidden]), input:not([hidden]):not([type="hidden"]):not([disabled]), select:not([hidden]):not([disabled]), textarea:not([hidden]):not([disabled]), [tabindex="0"]:not([hidden]):not([disabled]), summary:not([hidden]), [contenteditable]:not([hidden]), audio[controls]:not([hidden]), video[controls]:not([hidden])');u[0].classList.add(f),u[u.length-1].classList.add(p)}},c.setupModalCloseBtn=function(t,e,a){var o,d=t.hasAttribute("data-modal-manual-close"),i=t.querySelectorAll("[data-modal-close-btn]"),l=t.getAttribute("data-modal-close"),n=t.getAttribute("data-modal-close-class");if(!d&&i.length<2){var r=s.createElement("button");r.type="button",t.classList.add(e),r.classList.add(e+"__close-btn"),l||"alert"===a?(r.innerHTML=l,n&&r.classList.add(n)):(r.innerHTML="<span data-modal-x></span>",r.setAttribute("aria-label","Close"),r.classList.add("is-icon-btn")),"alert"!==a&&(t.querySelector('[role="document"]')?t.querySelector('[role="document"]').appendChild(r):t.appendChild(r)),r.addEventListener("click",c.closeModal)}for(o=0;o<i.length;o++)i[o].addEventListener("click",c.closeModal);s.addEventListener("keydown",c.keyEvents,!1)},c.openModal=function(t,e){var a,o=e||this.getAttribute("data-modal-open"),d=n=s.getElementById(o),i=n.querySelector("[autofocus]")||n.querySelector("[data-autofocus]");if(g=n.hasAttribute("aria-modal"),e&&(A=!0),e||(t.preventDefault(),l=this.id),i?d=i:n.hasAttribute("data-modal-close-focus")&&(d=n.querySelector('[class*="close-btn"]')),u.classList.contains(r))console.warn("It is not advised to open dialogs from within other dialogs. Instead consider replacing the contents of this dialog with new content. Or providing a stepped, or tabbed interface within this dialog.");else for(u.classList.add(r),a=0;a<m.length;a++)g||(m[a].hasAttribute("aria-hidden")&&m[a].setAttribute("data-keep-hidden",m[a].getAttribute("aria-hidden")),m[a].setAttribute("aria-hidden","true")),m[a].getAttribute("inert")?m[a].setAttribute("data-keep-inert",""):m[a].setAttribute("inert","true");return n.removeAttribute("hidden"),requestAnimationFrame(function(){d.focus()}),s.addEventListener("click",c.outsideClose,!1),s.addEventListener("touchend",c.outsideClose,!1),[l,n,A]},c.closeModal=function(t){var e,a,o=s.getElementById(l)||null;for(e=0;e<m.length;e++)m[e].hasAttribute("data-keep-inert")||m[e].removeAttribute("inert"),m[e].removeAttribute("data-keep-inert"),m[e].getAttribute("data-keep-hidden")?m[e].setAttribute("aria-hidden",m[e].getAttribute("data-keep-hidden")):m[e].removeAttribute("aria-hidden"),m[e].removeAttribute("data-keep-hidden");for(u.classList.remove(r),a=0;a<b.length;a++)b[a].hasAttribute("hidden")||(b[a].hidden=!0);return null!==o?o.focus():h&&!A?(h.tabIndex=-1,h.focus()):(u.tabIndex=-1,u.focus()),[l=d,n=d,A=!1]},c.keyEvents=function(t){var e=t.keyCode||t.which;if(t.target.hasAttribute("data-modal-open"))switch(e){case 13:case 32:t.preventDefault(),t.target.click()}if(u.classList.contains(r)){switch(e){case 27:c.closeModal()}if(u.classList.contains(r))var a=n.querySelector("."+f),o=n.querySelector("."+p);s.activeElement.classList.contains(p)&&(9!==e||t.shiftKey||(t.preventDefault(),a.focus())),s.activeElement.classList.contains(f)&&9===e&&t.shiftKey&&(t.preventDefault(),o.focus())}},c.outsideClose=function(t){u.classList.contains(r)&&!t.target.hasAttribute("data-modal-open")&&(n.contains(t.target)||"alertdialog"===n.getAttribute("role")||c.closeModal())},c.autoLoad=function(){var t,e=s.querySelectorAll("[data-modal-auto]"),a=i.location.hash||null,o=!1;if(null!==a){if(""===(t=a.split("#")[1]))return!1;if("!null"===t)return!1;var d=s.getElementById(t)||null;null!==d&&("dialog"!==d.getAttribute("role")&&"alertdialog"!==d.getAttribute("role")||(o=!0))}o?(c.openModal(null,t),1<e.length&&console.warn("Only the modal indicated by the hash value will load.")):0!==e.length&&("dialog"===e[0].getAttribute("role")||"alertdialog"===e[0].getAttribute("role")?(t=e[0].id,c.openModal(null,t),1<e.length&&console.warn("Multiple modal dialogs can not auto load.")):"button"!==e[0].getAttribute("role")&&"BUTTON"!==e[0].tagName||(t=e[0].id,e[0].click())),0===e.length||s.getElementById(t).hasAttribute("data-modal-auto-persist")||i.location.replace("#!null")},c.init=function(){c.organizeDOM(),c.setupTrigger(),c.setupModal(),c.autoLoad()},c.init()}(window,document);